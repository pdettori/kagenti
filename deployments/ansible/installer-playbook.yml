---
- name: Install Kagenti components
  hosts: localhost
  connection: local
  gather_facts: false
  collections:
    - kubernetes.core
  vars_files:
    - values.yaml
  vars:
    # Allow overriding which Python interpreter Ansible should use. Prefer an
    # environment-provided value (ANSIBLE_PYTHON_INTERPRETER), otherwise fall
    # back to the repository's .venv-ansible if present (relative to the
    # playbook directory). You can also pass this via -e when running the
    # playbook, e.g. -e "ansible_python_interpreter=/path/to/python".
    ansible_python_interpreter: "{{ lookup('env','ANSIBLE_PYTHON_INTERPRETER') | default(playbook_dir + '/../../.venv/bin/python', true) }}"

    # Optional path to a secret values YAML file. If provided, it will be loaded
    # and merged into chart values for deployments. Can be passed via -e
    # e.g. -e "secret_values_file=.secret_values.yaml"
    secret_values_file: "{{ secret_values_file | default('') }}"
  roles:
    - role: kagenti_installer
