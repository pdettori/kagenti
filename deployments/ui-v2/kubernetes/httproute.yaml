# Copyright 2025 IBM Corp.
# Licensed under the Apache License, Version 2.0

# HTTPRoute for Kubernetes Gateway API
# Requires Gateway API CRDs and an Ingress controller (e.g., Istio)
apiVersion: gateway.networking.k8s.io/v1
kind: HTTPRoute
metadata:
  name: kagenti-ui
  namespace: kagenti-system
  labels:
    app.kubernetes.io/name: kagenti-ui
spec:
  parentRefs:
    - name: kagenti-gateway
      namespace: kagenti-system
  hostnames:
    - "kagenti-ui.localtest.me"
  rules:
    # Route /api/* to backend
    - matches:
        - path:
            type: PathPrefix
            value: /api
      backendRefs:
        - name: kagenti-backend
          port: 8000
    # Route everything else to frontend
    - matches:
        - path:
            type: PathPrefix
            value: /
      backendRefs:
        - name: kagenti-ui
          port: 8080
