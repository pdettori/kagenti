# This template creates secrets in the existing kagenti-system namespace
# for AgentBuilds that run in kagenti-system (centralized build pattern).
# Unlike agent-namespaces.yaml, this does NOT create the namespace itself,
# as kagenti-system already exists from the platform installation.
---
# GitHub Token Secret (for AgentBuilds in kagenti-system)
apiVersion: v1
kind: Secret
metadata:
  name: github-token-secret
  namespace: kagenti-system
  labels:
    {{- include "kagenti.labels" . | nindent 4 }}
type: Opaque
stringData:
  user: {{ .Values.secrets.githubUser | quote }}
  token: {{ .Values.secrets.githubToken | quote }}
---
# GHCR Docker Registry Secret (for pulling private images in kagenti-system)
apiVersion: v1
kind: Secret
metadata:
  name: ghcr-secret
  namespace: kagenti-system
  labels:
    {{- include "kagenti.labels" . | nindent 4 }}
type: kubernetes.io/dockerconfigjson
data:
  .dockerconfigjson: {{ (printf "{\"auths\":{\"ghcr.io\":{\"username\":\"%s\",\"password\":\"%s\",\"auth\":\"%s\"}}}" .Values.secrets.githubUser .Values.secrets.githubToken (printf "%s:%s" .Values.secrets.githubUser .Values.secrets.githubToken | b64enc)) | b64enc }}
---
# OpenAI API Key Secret (for builds in kagenti-system)
apiVersion: v1
kind: Secret
metadata:
  name: openai-secret
  namespace: kagenti-system
  labels:
    {{- include "kagenti.labels" . | nindent 4 }}
type: Opaque
stringData:
  apikey: {{ .Values.secrets.openaiApiKey | quote }}
---
# Quay.io Docker Registry Secret (for pushing images in kagenti-system)
apiVersion: v1
kind: Secret
metadata:
  name: quay-registry-secret
  namespace: kagenti-system
  labels:
    {{- include "kagenti.labels" . | nindent 4 }}
type: kubernetes.io/dockerconfigjson
data:
  .dockerconfigjson: {{ (printf "{\"auths\":{\"quay.io\":{\"username\":\"%s\",\"password\":\"%s\",\"auth\":\"%s\"}}}" .Values.secrets.quayUser .Values.secrets.quayToken (printf "%s:%s" .Values.secrets.quayUser .Values.secrets.quayToken | b64enc)) | b64enc }}
