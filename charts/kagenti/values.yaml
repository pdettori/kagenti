# Global settings
openshift: true

# ------------------------------------------------------------------
#  Control Panel: Enable or disable components here
# ------------------------------------------------------------------
components:
  agentNamespaces:
    enabled: true
  mcpGateway:
    enabled: true
  platformOperator:
    enabled: true
  kagentiOperator:
    enabled: true
  ui:
    enabled: true
  istio:
    enabled: true  

# Environment variables for secrets - they should be overriden by a .secrets.yaml file
# or by using --set secrets.githubUser="" etc.
secrets:
  githubUser: ""
  githubToken: ""
  openaiApiKey: ""
  slackBotToken: ""
  adminSlackBotToken: ""
  quayUser: ""
  quayToken: ""

common:
  kubectlImage: "quay.io/kubestellar/kubectl:1.30.14"

# ------------------------------------------------------------------
#  Components Configurations
# ------------------------------------------------------------------

# ------------------------------------------------------------------
#  Agents Namespaces
# ------------------------------------------------------------------
agentNamespaces:
- kagenti-system  # Needed for AgentBuilds running in kagenti-system
- team1
- team2

# ------------------------------------------------------------------
#  UI Configuration
# ------------------------------------------------------------------
ui:
  configmap: kagenti-ui-config
  auth:
    enabled: true
  namespace: kagenti-system
  image: ghcr.io/kagenti/kagenti/ui
  tag: v0.1.0-alpha.12
  hostname: kagenti-ui.localtest.me
  url: http://kagenti-ui.localtest.me:8080

# ------------------------------------------------------------------
#  UI OAuth Secret Creator Configuration
# ------------------------------------------------------------------
uiOAuthSecret:
  image: ghcr.io/kagenti/kagenti/ui-oauth-secret
  tag: latest
  # When true, mount the in-cluster serviceaccount CA 
  # into the ui-oauth-secret job via the SSL_CERT_FILE environment variable.
  # When false, the serviceaccount CA is only for the API server
  # and will usually not validate external OpenShift route certificates.
  useServiceAccountCA: true

# ------------------------------------------------------------------
#  Agent OAuth Secret Creator Configuration
# ------------------------------------------------------------------
agentOAuthSecret:
  image: ghcr.io/kagenti/kagenti/agent-oauth-secret
  tag: latest
  # When true, mount the in-cluster serviceaccount CA 
  # into the agent-oauth-secret job via the SSL_CERT_FILE environment variable.
  # When false, the serviceaccount CA is only for the API server
  # and will usually not validate external OpenShift route certificates.
  useServiceAccountCA: false
  spiffePrefix: spiffe://localtest.me/sa
  updateEnvConfigMaps: true
  clientName: kagenti-keycloak-client

# ------------------------------------------------------------------
#  Keycloak Configuration
# ------------------------------------------------------------------
keycloak:
  enabled: true
  namespace: keycloak
  adminSecretName: keycloak-initial-admin
  adminUsernameKey: username
  adminPasswordKey: password
  url: http://keycloak-service.keycloak:8080
  publicUrl: http://keycloak.localtest.me:8080
  realm: demo

# ------------------------------------------------------------------
#  Platform Operator Configuration
# ------------------------------------------------------------------
kagenti-platform-operator-chart:
  controllerManager:
    container:
      args:
      - "--leader-elect"
      - "--metrics-bind-address=:8443"
      - "--health-probe-bind-address=:8081"
      - "--webhook-cert-path=/tmp/k8s-webhook-server/serving-certs"
      # TODO this should be controllable with a helm value flag in kagenti-platform-operator-chart
      # - "--enable-client-registration=false"
      resources:
        limits:
          memory: 512Mi

# ------------------------------------------------------------------
#  Kagenti Operator Configuration
# ------------------------------------------------------------------
kagenti-operator-chart:
  controllerManager:
    container:
      image:
        tag: 0.2.0-alpha.17
      args:
      - "--leader-elect"
      - "--metrics-bind-address=:8443"
      - "--health-probe-bind-address=:8081"
      - "--webhook-cert-path=/tmp/k8s-webhook-server/serving-certs"
      resources:
        limits:
          memory: 512Mi

# ------------------------------------------------------------------
#  MCP Gateway Configuration
# ------------------------------------------------------------------
mcpGateway:
  namespaces:
    mcpSystem: mcp-system
    gatewaySystem: gateway-system
  # TODO: Investigate why only the hostname 'mcp.127-0-0-1.sslip.io' works for MCP Gateway.
  # Observed behavior: When using this hostname, the MCP Gateway is accessible and functions as expected.
  # Other values tried:  'mcp.localtest.me', and 'mcp.sslip.io' were tested but failed to route traffic correctly.
  # Expected behavior: The MCP Gateway should work with any valid hostname or IP address configured for local development.
  hostname: 'mcp.127-0-0-1.sslip.io'  

# ------------------------------------------------------------------
#  Spiffe/Spire configs
# ------------------------------------------------------------------
spire:
  enabled: true