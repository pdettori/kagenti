# Global settings
openshift: true
# OpenShift version (e.g., "4.20.8") - if provided, skips cluster lookup for version detection
# This is useful when helm diff/template can't access the cluster for lookups
ocpVersion: ""
# Set to true to skip ZTWIM operator installation even on OpenShift
# Used when installing SPIRE via Helm charts (e.g., OCP < 4.19 where ZTWIM is not available)
useSpireHelmChart: false

domain: localtest.me

# ------------------------------------------------------------------
#   Enable or disable components here
# ------------------------------------------------------------------
components:
  mcpInspector:
    enabled: true
  istio:
    enabled: true
  kiali:
    enabled: true
  keycloak:
    enabled: true
  metricsServer:
    enabled: false
  otel:
    enabled: true
  mlflow:
    enabled: false
  containerRegistry:
    enabled: false
  spire:
    enabled: true
  tekton:
    enabled: true
  shipwright:
    enabled: true
  certManager:
    enabled: true
  gatewayApi:
    enabled: false
  ingressGateway:
    enabled: false

common:
  kubectlImage: "quay.io/kubestellar/kubectl:1.30.14"

# ------------------------------------------------------------------
#  Components Configurations
# ------------------------------------------------------------------


# ------------------------------------------------------------------
#  Keycloak Configuration
# ------------------------------------------------------------------
keycloak:
  namespace: keycloak
  auth:
    adminUser: keycloakadmin
    adminPassword: your-secret-password
  # Secret containing Keycloak admin credentials (created by RHBK operator)
  adminSecretName: keycloak-initial-admin
  adminUsernameKey: username
  adminPasswordKey: password
  # Internal Keycloak URL for OAuth secret jobs
  url: http://keycloak-service.keycloak:8080
  publicUrl: http://keycloak.localtest.me:8080
  realm: demo
  httpRoute:
    annotations: {}
    parentRefs:
    - name: http
      namespace: kagenti-system
    hostnames:
      - "keycloak.localtest.me"
      - "www.keycloak.localtest.me"
    rules:
    - matches:
      - path:
          type: PathPrefix
          value: /


# ------------------------------------------------------------------
#  Istio Configuration
# ------------------------------------------------------------------
istio:
  communityCharts:
    enabled: false
  namespace: "istio-system"
  gatewayApiVersion: "v1.1.0"
  cni:
    profile: ambient
    namespace: istio-cni
  ztunnel:
    namespace: istio-ztunnel
  base: {}
  istiod:
    profile: ambient
    namespace: '{{ .Values.istio.namespace | quote }}'

httpGateway:
  name: http
  namespace: "kagenti-system"
# ------------------------------------------------------------------
#  Shipwright / OpenShift Builds Configuration
# ------------------------------------------------------------------
shipwright:
  namespace: openshift-builds
  channel: latest

# ------------------------------------------------------------------
#  Cert Manager Configuration
# ------------------------------------------------------------------
certManager:
  namespace: cert-manager-operator

# ------------------------------------------------------------------
#  Spire Configuration
# ------------------------------------------------------------------
spire:
  namespace: zero-trust-workload-identity-manager
  trustDomain: localtest.me
  # OLM channel for ZTWIM operator. Use "stable-v1" for OCP 4.20+, "tech-preview-v0.2" for OCP 4.19
  channel: stable-v1

containerRegistry:
  namespace: cr-system
  name: registry
  replicaCount: 1
  image:
    repository: ghcr.io/distribution/distribution
    tag: "3.0.0"
    pullPolicy: IfNotPresent

  service:
    type: ClusterIP
    port: 5000
    targetPort: 5000

  env:
    otelTracesExporter: "none"
    logLevel: "info"
  # Resource defaults for the registry container
  resources:
    limits:
      cpu: 150m
      memory: 256Mi
    requests:
      cpu: 50m
      memory: 128Mi

# ------------------------------------------------------------------
#  Metrics Server Configuration
# ------------------------------------------------------------------

metricsServer:
  insecure: true
  namespace: kube-system

# ------------------------------------------------------------------
#  MCP inspector
# ------------------------------------------------------------------

mcpInspector:
  image: ghcr.io/modelcontextprotocol/inspector
  tag: 0.17.2

# ------------------------------------------------------------------
#  Phoenix Configuration
# ------------------------------------------------------------------
phoenix:
  auth:
    # Enable Keycloak OAuth2 authentication for Phoenix dashboard
    # Set to true in ocp_values.yaml for production deployments
    enabled: false
    secretName: phoenix-oauth-secret

# ------------------------------------------------------------------
#  MLflow Configuration
# ------------------------------------------------------------------
mlflow:
  auth:
    # Enable Keycloak OAuth2 authentication for MLflow
    # Set to true in ocp_values.yaml for production deployments
    enabled: false
    secretName: mlflow-oauth-secret

# ------------------------------------------------------------------
#  MLflow OAuth Secret Job Configuration
# ------------------------------------------------------------------
mlflowOAuthSecret:
  image: quay.io/ladas/mlflow-oauth-secret
  tag: latest
  # Keycloak client ID for MLflow
  clientId: mlflow
  # Kubernetes secret name to store OAuth credentials
  secretName: mlflow-oauth-secret
  # Use OpenShift service account CA for SSL verification
  useServiceAccountCA: true